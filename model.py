import pandas as pd
import numpy as np
from sklearn.model_selection import ShuffleSplit, cross_val_score
from sklearn.preprocessing import StandardScaler
from sklearn.ensemble import RandomForestClassifier
import pickle


data = pd.read_csv("final_embeddings.csv")


X = data.iloc[:, 1:-1].values  
y = data.iloc[:, -1].values     # 1 for benign, 0 for malware


scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

# Random forest
classifier = RandomForestClassifier(n_estimators=100, random_state=42)


cv = ShuffleSplit(n_splits=5, test_size=0.2, random_state=42)


cv_scores = cross_val_score(classifier, X_scaled, y, cv=cv)


classifier.fit(X_scaled, y)


pickle.dump(classifier, open("model.pkl", "wb"))
